<?php
// $Id$

function rest_server_server_info() {
  return array(
    '#name' => 'REST',
    '#path' => 'rest',
  );
}

function rest_server_autoload_info() {
  return array(
    'RESTServer' => array(
      'file' => 'includes/RESTServer.inc',
    ),
    'RESTServerViewBuiltIn' => array(
      'file' => 'includes/rest_server.views.inc',
    ),
    'RESTServerView' => array(
      'file' => 'includes/rest_server.views.inc',
    ),
    'ResourceFeedModel' => array(
      'file' => 'includes/models.inc',
    ),
    'ResourceFeedModelItem' => array(
      'file' => 'includes/models.inc',
    ),
    'ResourceTimeFeedModel' => array(
      'file' => 'includes/models.inc',
    ),
    'ResourceTimeFeedModelItem' => array(
      'file' => 'includes/models.inc',
    ),
    'NodeResourceFeedModel' => array(
      'file' => 'include/node.models.inc',
    ),
    'NodeResourceFeedModelItem' => array(
      'file' => 'include/node.models.inc',
    ),
  );
}

function rest_server_server($endpoint = 'services/rest') {
  global $base_path;
  $endpoint_path = trim(trim($base_path, '/') . '/' . $endpoint, '/');
  $canonical_path = trim(substr($_GET['q'], drupal_strlen($endpoint_path)), '/');

  $server = new RESTServer();
  return $server->handle($canonical_path, $endpoint_path);
}

function rest_server_server_error($message, $code=0, $exception=NULL) {
  throw new Exception($message, $code);
}